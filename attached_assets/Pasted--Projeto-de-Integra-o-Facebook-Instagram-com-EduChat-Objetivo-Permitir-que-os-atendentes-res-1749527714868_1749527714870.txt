ğŸ§© Projeto de IntegraÃ§Ã£o Facebook & Instagram com EduChat
ğŸ¯ Objetivo
Permitir que os atendentes respondam mensagens do Facebook Messenger, Instagram Direct e comentÃ¡rios de postagens (Facebook e Instagram) diretamente pela interface da caixa de entrada do EduChat.

1. PrÃ©-requisitos TÃ©cnicos
Conta de desenvolvedor Meta: https://developers.facebook.com

PÃ¡gina do Facebook conectada ao Instagram

PermissÃµes concedidas ao aplicativo para acessar mensagens e comentÃ¡rios

Token de acesso com permissÃµes adequadas (via OAuth 2.0)

AtivaÃ§Ã£o das APIs:

Messenger API for Instagram

Facebook Graph API

Instagram Graph API

Webhooks (Real-Time Updates)

2. Escopo da IntegraÃ§Ã£o
ğŸ” Fluxos de ComunicaÃ§Ã£o
ğŸ“© Facebook Messenger: Enviar e receber mensagens

ğŸ“¥ Instagram Direct: Enviar e receber mensagens diretas

ğŸ’¬ ComentÃ¡rios Facebook: Ler e responder comentÃ¡rios

ğŸ’¬ ComentÃ¡rios Instagram: Ler e responder comentÃ¡rios

3. Estrutura TÃ©cnica (Back-end)
ğŸ—‚ï¸ Pastas e Arquivos
pgsql
Copiar
Editar
server/
â”œâ”€â”€ integrations/
â”‚   â”œâ”€â”€ facebook/
â”‚   â”‚   â”œâ”€â”€ messenger.ts
â”‚   â”‚   â”œâ”€â”€ instagram.ts
â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â””â”€â”€ meta-auth.ts
â”œâ”€â”€ webhooks/
â”‚   â”œâ”€â”€ facebook.ts
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ facebook/
â”‚   â”‚   â”œâ”€â”€ messages.ts
â”‚   â”‚   â”œâ”€â”€ comments.ts
â”‚   â”‚   â””â”€â”€ auth.ts
4. Funcionalidades Back-end
âœ… AutenticaÃ§Ã£o OAuth
Endpoint: GET /facebook/auth

Fluxo: redirecionar para login â†’ obter access_token â†’ armazenar token e pÃ¡ginas vinculadas

ğŸ“¨ Webhooks
Endpoint: POST /webhooks/facebook

Verificar assinatura (X-Hub-Signature)

Receber:

Mensagens inbox

Mensagens direct

ComentÃ¡rios em postagens

ğŸ’¬ Enviar Mensagens
POST /facebook/send-message

Campos: recipientId, message, type

ğŸ’¬ Responder ComentÃ¡rios
POST /facebook/comment-reply

Campos: commentId, message

5. Interface no EduChat (Front-end)
ğŸ’¡ Novo Canal: Facebook & Instagram
Novo Ã­cone de origem no ContactBubble

Filtro de canais: WhatsApp, Instagram, Facebook, Interno, etc.

âœï¸ Caixa de Entrada
Receber mensagens de mÃºltiplas plataformas (Messenger, Direct, ComentÃ¡rios)

BotÃµes de aÃ§Ã£o (curtir, responder, ocultar)

ğŸ“¤ Campo de Envio
Envio normal de texto

IdentificaÃ§Ã£o do tipo (DM vs comentÃ¡rio)

6. Banco de Dados
ğŸ”ƒ Tabelas/Modelos
social_channels (id, platform, page_id, access_token, name)

social_messages (id, contact_id, channel_id, platform, content, type, meta)

7. SeguranÃ§a
ValidaÃ§Ã£o de token expirado

RenovaÃ§Ã£o com long-lived token (60 dias)

Logs de erro e fallback

8. Etapas de ImplementaÃ§Ã£o
Etapa	DescriÃ§Ã£o	Status
1	Configurar App na Meta Developers	ğŸ”„
2	Implementar OAuth e salvar tokens	ğŸ”„
3	Criar Webhook para mensagens e comentÃ¡rios	ğŸ”„
4	Desenvolver rotas de envio/resposta	ğŸ”„
5	Integrar com inbox do EduChat	ğŸ”„
6	Testar todos os fluxos com usuÃ¡rios reais	ğŸ”„

9. DocumentaÃ§Ã£o e Monitoramento
Registrar logs de mensagens recebidas e enviadas

Adicionar mÃ©tricas de tempo de resposta por canal

DocumentaÃ§Ã£o leve para manutenÃ§Ã£o futura