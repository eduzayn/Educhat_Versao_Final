🧩 Projeto de Integração Facebook & Instagram com EduChat
🎯 Objetivo
Permitir que os atendentes respondam mensagens do Facebook Messenger, Instagram Direct e comentários de postagens (Facebook e Instagram) diretamente pela interface da caixa de entrada do EduChat.

1. Pré-requisitos Técnicos
Conta de desenvolvedor Meta: https://developers.facebook.com

Página do Facebook conectada ao Instagram

Permissões concedidas ao aplicativo para acessar mensagens e comentários

Token de acesso com permissões adequadas (via OAuth 2.0)

Ativação das APIs:

Messenger API for Instagram

Facebook Graph API

Instagram Graph API

Webhooks (Real-Time Updates)

2. Escopo da Integração
🔁 Fluxos de Comunicação
📩 Facebook Messenger: Enviar e receber mensagens

📥 Instagram Direct: Enviar e receber mensagens diretas

💬 Comentários Facebook: Ler e responder comentários

💬 Comentários Instagram: Ler e responder comentários

3. Estrutura Técnica (Back-end)
🗂️ Pastas e Arquivos
pgsql
Copiar
Editar
server/
├── integrations/
│   ├── facebook/
│   │   ├── messenger.ts
│   │   ├── instagram.ts
│   │   └── utils.ts
│   └── meta-auth.ts
├── webhooks/
│   ├── facebook.ts
├── routes/
│   ├── facebook/
│   │   ├── messages.ts
│   │   ├── comments.ts
│   │   └── auth.ts
4. Funcionalidades Back-end
✅ Autenticação OAuth
Endpoint: GET /facebook/auth

Fluxo: redirecionar para login → obter access_token → armazenar token e páginas vinculadas

📨 Webhooks
Endpoint: POST /webhooks/facebook

Verificar assinatura (X-Hub-Signature)

Receber:

Mensagens inbox

Mensagens direct

Comentários em postagens

💬 Enviar Mensagens
POST /facebook/send-message

Campos: recipientId, message, type

💬 Responder Comentários
POST /facebook/comment-reply

Campos: commentId, message

5. Interface no EduChat (Front-end)
💡 Novo Canal: Facebook & Instagram
Novo ícone de origem no ContactBubble

Filtro de canais: WhatsApp, Instagram, Facebook, Interno, etc.

✍️ Caixa de Entrada
Receber mensagens de múltiplas plataformas (Messenger, Direct, Comentários)

Botões de ação (curtir, responder, ocultar)

📤 Campo de Envio
Envio normal de texto

Identificação do tipo (DM vs comentário)

6. Banco de Dados
🔃 Tabelas/Modelos
social_channels (id, platform, page_id, access_token, name)

social_messages (id, contact_id, channel_id, platform, content, type, meta)

7. Segurança
Validação de token expirado

Renovação com long-lived token (60 dias)

Logs de erro e fallback

8. Etapas de Implementação
Etapa	Descrição	Status
1	Configurar App na Meta Developers	🔄
2	Implementar OAuth e salvar tokens	🔄
3	Criar Webhook para mensagens e comentários	🔄
4	Desenvolver rotas de envio/resposta	🔄
5	Integrar com inbox do EduChat	🔄
6	Testar todos os fluxos com usuários reais	🔄

9. Documentação e Monitoramento
Registrar logs de mensagens recebidas e enviadas

Adicionar métricas de tempo de resposta por canal

Documentação leve para manutenção futura